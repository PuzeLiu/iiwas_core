<?xml version="1.0"?>
<launch>
    <arg name="use_front_iiwa" default="true" />
    <arg name="use_back_iiwa" default="false" />
    <arg name="hardware_interface" default="hardware_interface/EffortJointInterface"/>
    <arg name="machine_name" default="realtime" />
    <arg name="machine_address" default="192.168.10.1" />
    <arg name="front_controllers" default="joint_torque_trajectory_controller" />
    <arg name="back_controllers" default="joint_position_trajectory_controller" />

    <machine name="$(arg machine_name)" user="puze" address="$(arg machine_address)"
         env-loader="~/catkin_ws/src/iiwas_core/iiwas_bringup/env.sh" timeout="10.0" default="false"/>

    <!-- Description -->
    <include file="$(find iiwas_description)/launch/iiwas_bringup.launch">
        <arg name="use_front_iiwa" value="$(arg use_front_iiwa)"/>
        <arg name="use_back_iiwa" value="$(arg use_back_iiwa)"/>
        <arg name="hardware_interface" value="$(arg hardware_interface)"/>
    </include>

    <node name="rviz" pkg="rviz" type="rviz"
          args="-d $(find iiwas_description)/config/iiwas_two_separate.rviz"/>

    <group ns="iiwas_frame">
        <node pkg="robot_state_publisher" type="robot_state_publisher" name="frame_publisher" output="screen">
            <param name="publish_frequency" type="double" value="50.0"/>
        </node>
    </group>

    <arg name="front_control_mode" value="0" if="$(eval front_controllers == 'joint_position_trajectory_controller')"/>
    <arg name="front_control_mode" value="1" if="$(eval front_controllers == 'joint_position_impedance_trajectory_controller')"/>
    <arg name="front_control_mode" value="2" if="$(eval front_controllers == 'joint_torque_trajectory_controller')"/>
    <arg name="back_control_mode" value="0" if="$(eval back_controllers == 'joint_position_trajectory_controller')"/>
    <arg name="back_control_mode" value="1" if="$(eval back_controllers == 'joint_position_impedance_trajectory_controller')"/>
    <arg name="back_control_mode" value="2" if="$(eval back_controllers == 'joint_torque_trajectory_controller')"/>

    <include file="$(find iiwas_driver)/launch/iiwas_driver.launch" >
        <arg name="use_front_iiwa" value="$(arg use_front_iiwa)"/>
        <arg name="use_back_iiwa" value="$(arg use_back_iiwa)"/>
        <arg name="front_control_mode" value="$(arg front_control_mode)"/>
        <arg name="back_control_mode" value="$(arg back_control_mode)"/>
        <arg name="machine_name" value="$(arg machine_name)" />
    </include>

    <!-- Controllers -->
    <include file="$(find iiwas_control)/launch/iiwas_control.launch">
        <arg name="use_front_iiwa" value="$(arg use_front_iiwa)" />
        <arg name="use_back_iiwa" value="$(arg use_back_iiwa)" />
        <arg name="front_controllers" value="$(arg front_controllers)"/>
        <arg name="back_controllers" value="$(arg back_controllers)"/>
    </include>



</launch>
